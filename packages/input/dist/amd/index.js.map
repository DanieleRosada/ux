{"version":3,"file":"index.js","sources":["../../src/ux-input.ts","../../src/ux-input-theme.ts","../../src/index.ts"],"sourcesContent":["import { customElement, bindable, inlineView } from 'aurelia-templating';\nimport { DOM } from 'aurelia-pal';\nimport { observable } from 'aurelia-binding';\nimport { inject } from 'aurelia-dependency-injection';\nimport { StyleEngine, UxComponent } from '@aurelia-ux/core';\nimport { UxInputTheme } from './ux-input-theme';\nimport * as VIEW from './ux-input.html';\n\nexport interface UxInputElement extends HTMLElement {\n  value: any;\n}\n\n@inject(Element, StyleEngine)\n@customElement('ux-input')\n@inlineView(VIEW)\nexport class UxInput implements UxComponent {\n  private ignoreRawChanges: boolean;\n\n  @bindable public autofocus = null;\n  @bindable public autocomplete: string;\n  @bindable public disabled: any = false;\n  @bindable public maxlength: number;\n  @bindable public minlength: number;\n  @bindable public min: number;\n  @bindable public max: number;\n  @bindable public readonly: any = false;\n  @bindable public theme: UxInputTheme;\n  @bindable public label: any;\n  @bindable public type: any;\n\n  @observable\n  public rawValue: string = '';\n\n  @observable\n  public focused: boolean = false;\n\n  public value: any;\n  public textbox: HTMLInputElement;\n\n  constructor(private element: UxInputElement, public styleEngine: StyleEngine) {\n    Object.setPrototypeOf(element, uxInputElementProto);\n  }\n\n  public bind() {\n    const element = this.element;\n    const textbox = this.textbox;\n\n    const textboxValue = this.textbox.getAttribute('value');\n    if (textboxValue != null) {\n      this.rawValue = textboxValue;\n    }\n\n    if (this.autofocus || this.autofocus === '') {\n      this.focused = true;\n    }\n\n    if (element.hasAttribute('id')) {\n      const attributeValue = element.getAttribute('id');\n\n      if (attributeValue) {\n        element.removeAttribute('id');\n        textbox.setAttribute('id', attributeValue);\n      }\n    }\n\n    if (element.hasAttribute('placeholder')) {\n      const attributeValue = element.getAttribute('placeholder');\n\n      if (attributeValue) {\n        this.label = attributeValue;\n      }\n    }\n\n    if (element.hasAttribute('step')) {\n      const attributeValue = element.getAttribute('step');\n\n      if (attributeValue) {\n        textbox.setAttribute('step', attributeValue);\n        element.removeAttribute('step');\n      }\n    }\n\n    if ([\n      'text',\n      'password',\n      'number',\n      'email',\n      'url',\n      'tel',\n      'search'\n    ].includes(this.type)) {\n      textbox.setAttribute('type', this.type);\n    }\n\n    if (this.min) {\n      textbox.setAttribute('min', this.min.toString());\n    }\n\n    if (this.max) {\n      textbox.setAttribute('max', this.max.toString());\n    }\n\n    if (this.minlength) {\n      textbox.setAttribute('minlength', this.minlength.toString());\n    }\n\n    if (this.maxlength) {\n      textbox.setAttribute('maxlength', this.maxlength.toString());\n    }\n\n    this.autocompleteChanged(this.autocomplete);\n    this.themeChanged(this.theme);\n  }\n\n  public attached() {\n    this.textbox.addEventListener('change', stopEvent);\n    this.textbox.addEventListener('input', stopEvent);\n  }\n\n  public detached() {\n    this.textbox.removeEventListener('change', stopEvent);\n    this.textbox.removeEventListener('input', stopEvent);\n  }\n\n  public getValue() {\n    return this.value;\n  }\n\n  public setValue(value: any) {\n    const oldValue = this.value;\n    const newValue = this.processRawValue(value);\n\n    if (oldValue !== newValue) {\n      this.value = newValue;\n      this.ignoreRawChanges = true;\n      this.rawValue = newValue === null || newValue === undefined ? '' : newValue.toString();\n      this.ignoreRawChanges = false;\n      this.element.dispatchEvent(DOM.createCustomEvent('change', { bubbles: true }));\n    }\n  }\n\n  private processRawValue(rawValue: string): any {\n    let newValue: any = rawValue;\n    if (this.type === 'number') {\n      newValue = rawValue === '' ? NaN : Number(rawValue);\n      if (isNaN(newValue)) {\n        newValue = null;\n      } else {\n        if (this.min !== undefined && this.min > newValue) {\n          newValue = this.min;\n        }\n        if (this.max !== undefined && newValue > this.max) {\n          newValue = this.max;\n        }\n      }\n    }\n    return newValue;\n  }\n\n  public autocompleteChanged(newValue: any) {\n    if (newValue == null) {\n      this.textbox.setAttribute('autocomplete', newValue);\n    } else {\n      this.textbox.removeAttribute('autocomplete');\n    }\n  }\n\n  public themeChanged(newValue: any) {\n    if (newValue != null && newValue.themeKey == null) {\n      newValue.themeKey = 'input';\n    }\n\n    this.styleEngine.applyTheme(newValue, this.element);\n  }\n\n  public focusedChanged(focused: boolean) {\n    if (focused === true) {\n      this.element.classList.add('ux-input--focused');\n    } else {\n      this.element.classList.remove('ux-input--focused');\n    }\n\n    this.element.dispatchEvent(DOM.createCustomEvent(focused ? 'focus' : 'blur', { bubbles: false }));\n  }\n\n  public typeChanged(newValue: any) {\n    if (newValue !== 'text' && newValue !== 'password' && newValue !== 'number') {\n      this.type = 'text';\n    }\n  }\n\n  public rawValueChanged(newValue: string) {\n    if (newValue.length > 0) {\n      this.element.classList.add('ux-input--has-value');\n    } else {\n      this.element.classList.remove('ux-input--has-value');\n    }\n\n    if (this.ignoreRawChanges) {\n      return;\n    }\n    this.setValue(newValue);\n  }\n\n  public focusInput() {\n    this.textbox.focus();\n  }\n}\n\nfunction stopEvent(e: Event) {\n  e.stopPropagation();\n}\n\nconst getVm = <T>(_: any) => _.au.controller.viewModel as T;\nconst uxInputElementProto = Object.create(HTMLElement.prototype, {\n  value: {\n    get() {\n      return getVm<UxInput>(this).getValue();\n    },\n    set(value: any) {\n      getVm<UxInput>(this).setValue(value);\n    }\n  }\n});\n","import { UxTheme } from '@aurelia-ux/core';\n\nexport class UxInputTheme implements UxTheme {\n  public themeKey = 'input';\n\n  public foreground: string;\n  public foregroundLabel: string;\n  public background: string;\n  public backgroundHover: string;\n\n  public fontSize: string;\n  public letterSpacing: string;\n  public labelFontSize: string;\n  public labelLetterSpacing: string;\n\n  public border: string;\n  public borderHover: string;\n  public borderFocus: string;\n  public borderRadius: string;\n  public borderBottom: string;\n  public borderBottomHover: string;\n  public borderBottomFocus: string;\n\n  public diabledForeground: string;\n  public disabledBackground: string;\n  public disabledBorder: string;\n\n  public error: string;\n}\n","/// <reference path=\"html.d.ts\" />\nimport { FrameworkConfiguration, bindingMode } from 'aurelia-framework';\nimport { ValueAttributeObserver, EventSubscriber } from 'aurelia-binding';\nimport { AureliaUX } from '@aurelia-ux/core';\nimport { UxInput } from './ux-input';\n\nexport { UxInputTheme } from './ux-input-theme';\nexport { UxInput, UxInputElement } from './ux-input';\n\nexport function configure(config: FrameworkConfiguration) {\n  config.container.get(AureliaUX).registerUxElementConfig(uxInputConfig);\n  config.globalResources(UxInput);\n}\n\nconst uxInputConfig = {\n  tagName: 'ux-input',\n  properties: {\n    value: {\n      defaultBindingMode: bindingMode.twoWay,\n      getObserver(element: Element) {\n        return new ValueAttributeObserver(element, 'value', new EventSubscriber(['change']));\n      }\n    }\n  }\n};\n"],"names":["DOM","bindable","observable","inject","StyleEngine","customElement","inlineView","AureliaUX","bindingMode","ValueAttributeObserver","EventSubscriber"],"mappings":"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"}
{"version":3,"file":"index.js","sources":["../../src/util.ts","../../src/ux-select.ts","../../src/ux-optgroup.ts","../../src/ux-option.ts","../../src/ux-select-theme.ts","../../src/index.ts"],"sourcesContent":["export function getAuViewModel<T = any>(el: any): T {\n  return el.au.controller.viewModel;\n}\n\nexport function bool(v: boolean | string) {\n  return !!(v || v === '');\n}\n","import {\n  customElement,\n  bindable,\n  computedFrom,\n  ViewResources,\n  ViewCompiler,\n  DOM,\n  processContent,\n  ElementEvents,\n  inject,\n  PLATFORM,\n  InternalCollectionObserver,\n  ObserverLocator,\n  TaskQueue,\n  inlineView,\n} from 'aurelia-framework';\n\nimport { getLogger } from 'aurelia-logging';\nimport { StyleEngine, UxComponent } from '@aurelia-ux/core';\n\nimport { UxSelectTheme } from './ux-select-theme';\nimport { UxOptGroupElement } from './ux-optgroup';\nimport { UxOptionElement } from './ux-option';\nimport { getAuViewModel, bool } from './util';\nimport * as UX_SELECT_VIEW from './ux-select.html';\n\ndeclare module './ux-option' {\n  interface UxOption {\n    uxSelect: UxSelect;\n  }\n}\n\ndeclare module './ux-optgroup' {\n  interface UxOptGroup {\n    uxSelect: UxSelect;\n  }\n}\n\nconst UP = 38;\n// const RIGHT = 39;\nconst DOWN = 40;\n// const LEFT = 37;\n// const ESC = 27;\nconst ENTER = 13;\nconst SPACE = 32;\nconst logger = getLogger('ux-select');\nconst invalidMultipleValueMsg = 'Only null or Array instances can be bound to a multi-select';\nconst selectArrayContext = 'context:ux-select';\n\nexport interface UxSelectElement<T = any> extends HTMLElement {\n  matcher(a: any, b: any): boolean;\n  value: T;\n}\n\nexport interface UxOptionContainer extends HTMLElement {\n  children: HTMLCollectionOf<UxOptGroupElement | UxOptionElement>;\n}\n\n@inject(Element, StyleEngine, ObserverLocator, TaskQueue)\n@processContent(extractUxOption)\n@customElement('ux-select')\n@inlineView(UX_SELECT_VIEW)\nexport class UxSelect implements UxComponent {\n\n  private selectedOption: UxOptionElement | null = null;\n\n  // Temporarily used to store <ux-option/> reference in interaction\n  private focusedUxOption: UxOptionElement | null;\n\n  // Observe window events\n  private winEvents: ElementEvents;\n\n  @bindable()\n  public theme: UxSelectTheme;\n\n  @bindable()\n  public autofocus: boolean | string;\n\n  @bindable({ defaultValue: false })\n  public disabled: boolean | string;\n\n  @bindable({ defaultValue: false })\n  public multiple: boolean | string;\n\n  @bindable()\n  public placeholder: string;\n\n  public value: any;\n  public displayValue: string;\n  public expanded: boolean;\n\n  // Populated by Aurelia\n  public readonly optionWrapperEl: HTMLElement;\n  public readonly optionCtEl: UxOptionContainer;\n\n  constructor(\n    public readonly element: UxSelectElement,\n    private styleEngine: StyleEngine,\n    private observerLocator: ObserverLocator,\n    private taskQueue: TaskQueue\n  ) {\n    // Only chrome persist the element prototype when cloning with clone node\n    Object.setPrototypeOf(element, UxSelectElementProto);\n  }\n\n  public bind() {\n    if (bool(this.autofocus)) {\n      // setTimeout(focusEl, 0, this.button);\n    }\n    if (this.isMultiple) {\n      if (!this.value) {\n        this.value = [];\n      } else if (!Array.isArray(this.value)) {\n        throw new Error(invalidMultipleValueMsg);\n      }\n    }\n    if (!this.winEvents) {\n      this.winEvents = new ElementEvents(window as any);\n    }\n    // Initially Synchronize options with value of this element\n    this.taskQueue.queueMicroTask(this);\n  }\n\n  public attached() {\n    this.resolveDisplayValue();\n  }\n\n  public unbind() {\n    this.winEvents.disposeAll();\n    if (this.arrayObserver) {\n      this.arrayObserver.unsubscribe(selectArrayContext, this);\n      this.arrayObserver = null;\n    }\n    this.selectedOption = null;\n  }\n\n  private resolveDisplayValue() {\n    const values = this.options\n      .filter(option =>\n        Array.isArray(this.value) ?\n          this.value.some(value => value === option.value) :\n          option.value === this.value)\n      .map(t => t.innerText);\n\n    this.displayValue = values.join(', ');\n\n    if (this.displayValue.length > 0) {\n      this.element.classList.add('ux-select--has-value');\n    } else {\n      this.element.classList.remove('ux-select--has-value');\n    }\n  }\n\n  private ignoreSelectEvent: boolean = true;\n  private synchronizeOptions() {\n    const value = this.value;\n    const isArray = Array.isArray(value);\n\n    const options = this.options;\n    const matcher = this.element.matcher || defaultMatcher;\n\n    let i = options.length;\n    this.ignoreSelectEvent = true;\n    while (i--) {\n      const option = options[i];\n      const optionValue = option.value;\n      if (isArray) {\n        option.selected = value.findIndex((item: any) => !!matcher(optionValue, item)) !== -1;\n        continue;\n      }\n      option.selected = !!matcher(optionValue, value);\n    }\n    this.ignoreSelectEvent = false;\n  }\n\n  private synchronizeValue() {\n    const options = this.options;\n    const ii = options.length;\n    let count = 0;\n    let optionValues: any[] | null = [];\n\n    // extract value from ux-option\n    for (let i = 0; i < ii; i++) {\n      const option = options[i];\n      if (!option.selected) {\n        continue;\n      }\n      optionValues.push(option.value);\n      count++;\n    }\n\n    if (this.isMultiple) {\n      // multi-select\n      if (Array.isArray(this.value)) {\n        const selectValues = this.value;\n        const matcher = this.element.matcher || defaultMatcher;\n        // remove items that are no longer selected.\n        let i = 0;\n        while (i < selectValues.length) {\n          const a = selectValues[i];\n          if (optionValues.findIndex(b => matcher(a, b)) === -1) {\n            selectValues.splice(i, 1);\n          } else {\n            i++;\n          }\n        }\n        // add items that have been selected.\n        i = 0;\n        while (i < optionValues.length) {\n          const a = optionValues[i];\n          if (selectValues.findIndex(b => matcher(a, b)) === -1) {\n            selectValues.push(a);\n          }\n          i++;\n        }\n        this.resolveDisplayValue();\n        return; // don't notify.\n      }\n    } else {\n      // single-select\n      // tslint:disable-next-line:prefer-conditional-expression\n      if (count === 0) {\n        optionValues = null;\n      } else {\n        optionValues = optionValues[0];\n      }\n      this.setValue(optionValues);\n    }\n  }\n\n  private setupListAnchor() {\n    this.calcAnchorPosition();\n    this.winEvents.subscribe('wheel', (e: WheelEvent) => {\n      if (this.expanded) {\n        if (e.target === PLATFORM.global || !this.optionWrapperEl.contains(e.target as HTMLElement)) {\n          this.collapse();\n        }\n      }\n    }, true);\n  }\n\n  private unsetupListAnchor() {\n    this.listAnchor = null;\n    this.winEvents.disposeAll();\n  }\n\n  public listAnchor: { x: number | string, y: number | string } | null;\n  private calcAnchorPosition() {\n    const elDim = this.element.getBoundingClientRect();\n    const offsetY = (48 - elDim.height) / 2;\n    this.listAnchor = { x: elDim.left, y: elDim.top - offsetY };\n  }\n\n  private onKeyboardSelect() {\n    if (!this.expanded) {\n      return;\n    }\n    const focusedOption = this.focusedUxOption;\n    if (this.isMultiple) {\n      if (!focusedOption) {\n        return;\n      }\n      focusedOption.selected = !focusedOption.selected;\n    } else {\n      this.collapse();\n    }\n  }\n\n  public call() {\n    this.synchronizeOptions();\n  }\n\n  public getValue() {\n    return this.value;\n  }\n\n  private arrayObserver: InternalCollectionObserver | null;\n  public setValue(newValue: any) {\n    if (newValue !== null && newValue !== undefined && this.isMultiple && !Array.isArray(newValue)) {\n      throw new Error('Only null, undenfined or Array instances can be bound to a multi-select.');\n    }\n\n    if (this.value === newValue) {\n      return;\n    }\n    // unsubscribe from old array.\n    if (this.arrayObserver) {\n      this.arrayObserver.unsubscribe(selectArrayContext, this);\n      this.arrayObserver = null;\n    }\n    if (this.isMultiple) {\n      // subscribe to new array.\n      if (Array.isArray(newValue)) {\n        this.arrayObserver = this.observerLocator.getArrayObserver(newValue);\n        this.arrayObserver.subscribe(selectArrayContext, this);\n      }\n    }\n    if (newValue !== this.value) {\n      this.value = newValue;\n      this.resolveDisplayValue();\n      this.element.dispatchEvent(DOM.createCustomEvent('change', { bubbles: true }));\n    }\n  }\n\n  private isExpanding: boolean;\n  public expand() {\n    if (this.expanded) {\n      return;\n    }\n    if (this.isExpanding) {\n      return;\n    }\n    this.isExpanding = true;\n    this.optionWrapperEl.classList.add('ux-select__list-wrapper--open');\n    setTimeout(() => {\n      this.optionCtEl.classList.add('ux-select__list-container--open');\n      this.isExpanding = false;\n      this.expanded = true;\n      this.setFocusedOption(this.selectedOption);\n    }, 0);\n    this.setupListAnchor();\n  }\n\n  private isCollapsing: boolean;\n  public collapse() {\n    if (this.isCollapsing) {\n      return;\n    }\n    this.isCollapsing = true;\n    this.optionCtEl.classList.remove('ux-select__list-container--open');\n    setTimeout(() => {\n      this.optionWrapperEl.classList.remove('ux-select__list-wrapper--open');\n      this.isCollapsing = false;\n      this.expanded = false;\n      this.setFocusedOption(null);\n      this.unsetupListAnchor();\n    }, this.theme && this.theme.listTransition || 125);\n  }\n\n  private setFocusedOption(focusedOption: UxOptionElement | null) {\n    const oldFocusedOption = this.focusedUxOption;\n    if (focusedOption !== oldFocusedOption) {\n      if (oldFocusedOption) {\n        oldFocusedOption.focused = false;\n      }\n      if (focusedOption) {\n        focusedOption.focused = true;\n        focusedOption.scrollIntoView({ block: 'nearest', inline: 'nearest' });\n      }\n      this.focusedUxOption = focusedOption;\n    }\n  }\n\n  public moveSelectedIndex(offset: number) {\n    let currentIndex: number = 0;\n    const options = this.options;\n    if (this.focusedUxOption) {\n      currentIndex = options.indexOf(this.focusedUxOption);\n    } else if (this.selectedOption) {\n      currentIndex = options.indexOf(this.selectedOption);\n    }\n    let nextIndex = currentIndex + offset;\n    if (nextIndex > options.length - 1) {\n      nextIndex = options.length - 1;\n    }\n    if (nextIndex < 0) {\n      nextIndex = 0;\n    }\n    const focusedOption = options[nextIndex];\n    if (focusedOption.disabled) {\n      if (offset > 0) {\n        if (nextIndex === options.length - 1) {\n          return;\n        }\n        this.moveSelectedIndex(offset + 1);\n      } else {\n        if (nextIndex < 0) {\n          return;\n        }\n        this.moveSelectedIndex(offset - 1);\n      }\n      return;\n    }\n    this.setFocusedOption(focusedOption);\n    focusedOption.focused = true;\n    if (this.isMultiple) {\n      // empty\n    } else {\n      this.ignoreSelectEvent = true;\n      if (this.selectedOption) {\n        this.selectedOption.selected = false;\n      }\n      this.selectedOption = focusedOption;\n      this.selectedOption.selected = true;\n      this.ignoreSelectEvent = false;\n      this.setValue(this.selectedOption.value);\n    }\n  }\n\n  public onTriggerClick() {\n    if (!this.isDisabled) {\n      if (this.expanded) {\n        return;\n      }\n      this.expand();\n    }\n  }\n\n  public onBlur() {\n    if (!this.element.contains(DOM.activeElement)) {\n      this.collapse();\n    }\n  }\n\n  public onSelect(e: CustomEvent) {\n    e.stopPropagation();\n    if (this.ignoreSelectEvent) {\n      return;\n    }\n    const newSelection: UxOptionElement = e.detail;\n    const lastSelection = this.selectedOption;\n    if (this.isMultiple) {\n      this.synchronizeValue();\n    } else {\n      this.ignoreSelectEvent = true;\n      if (lastSelection) {\n        lastSelection.selected = false;\n      }\n      this.ignoreSelectEvent = false;\n      this.selectedOption = newSelection;\n      this.setValue(newSelection.value);\n\n      if (this.expanded) {\n        this.collapse();\n      }\n    }\n  }\n\n  public onKeyDown(event: KeyboardEvent) {\n    if (this.isDisabled) {\n      return;\n    }\n    // tslint:disable-next-line:switch-default\n    switch (event.which) {\n      case UP: case DOWN:\n        this.moveSelectedIndex(event.which === UP ? -1 : 1);\n        event.preventDefault();\n        break;\n      case ENTER: case SPACE:\n        this.onKeyboardSelect();\n        event.preventDefault();\n        break;\n    }\n    return true;\n  }\n\n  public themeChanged(newValue: UxSelectTheme) {\n    if (newValue && !newValue.themeKey) {\n      newValue.themeKey = 'ux-select';\n    }\n\n    this.styleEngine.applyTheme(newValue, this.element);\n  }\n\n  public multipleChanged(newValue: boolean | string, oldValue: boolean | string) {\n    newValue = bool(newValue);\n    oldValue = bool(oldValue);\n    const hasChanged = newValue !== oldValue;\n\n    if (hasChanged) {\n      this.ignoreSelectEvent = true;\n      for (const opt of this.options) {\n        opt.selected = false;\n      }\n      this.ignoreSelectEvent = false;\n      this.selectedOption = null;\n      this.setValue(newValue\n        ? [] // Changing from single to multiple = reset value to empty array\n        : null // Changing from multiple to single = reset value to null\n      );\n    }\n  }\n\n  public get options(): UxOptionElement[] {\n    if (!this.optionCtEl) {\n      return [];\n    }\n    const result: UxOptionElement[] = [];\n    const children = this.optionCtEl.children;\n    const ii = children.length;\n    for (let i = 0; ii > i; ++i) {\n      const element = children[i];\n      if (element.nodeName === 'UX-OPTION') {\n        result.push(element);\n      } else if (element.nodeName === 'UX-OPTGROUP') {\n        const groupOptions = element.options;\n        const jj = groupOptions.length;\n        for (let j = 0; jj > j; ++j) {\n          result.push(groupOptions[j]);\n        }\n      }\n    }\n    return result;\n  }\n\n  public getOptions() {\n    return this.options;\n  }\n\n  @computedFrom('multiple')\n  public get isMultiple() {\n    return bool(this.multiple);\n  }\n\n  @computedFrom('disabled')\n  public get isDisabled() {\n    return bool(this.disabled);\n  }\n}\n\nfunction extractUxOption(\n  _: ViewCompiler,\n  __: ViewResources,\n  node: HTMLElement\n) {\n  if (node.hasAttribute('containerless')) {\n    logger.warn('Cannot use containerless on <ux-select/>. Consider using as-element instead.');\n    node.removeAttribute('containerless');\n  }\n  let currentChild: any = node.firstChild;\n\n  while (currentChild) {\n    const nextSibling = currentChild.nextSibling;\n    if (currentChild.nodeName === 'UX-OPTION' || currentChild.nodeName === 'UX-OPTGROUP') {\n      currentChild = nextSibling;\n      continue;\n    }\n    node.removeChild(currentChild);\n    currentChild = nextSibling;\n  }\n  return true;\n}\n\nconst UxSelectElementProto = Object.create(HTMLElement.prototype, {\n  value: {\n    get() {\n      return getAuViewModel<UxSelect>(this).getValue();\n    },\n    set(v: any) {\n      return getAuViewModel<UxSelect>(this).setValue(v);\n    }\n  },\n  options: {\n    get() {\n      return getAuViewModel<UxSelect>(this).getOptions();\n    }\n  }\n});\n\nfunction defaultMatcher<T = any>(a: T, b: T) {\n  return a === b;\n}\n","import {\n  customElement,\n  bindable,\n  ViewCompiler,\n  ViewResources,\n  processContent,\n  DOM,\n  inject,\n  inlineView,\n  BindingEngine,\n  Disposable,\n} from 'aurelia-framework';\n\nimport { UxOptionElement } from './ux-option';\nimport { getAuViewModel } from './util';\nimport * as UX_OPTGROUP_VIEW from './ux-optgroup.html';\n\ndeclare module './ux-option' {\n  interface UxOption {\n    optGroup: UxOptGroup | null;\n  }\n}\n\nexport interface UxOptGroupElement extends HTMLElement {\n  nodeName: 'UX-OPTGROUP';\n  options: UxOptionElement[];\n}\n\nexport interface OptGroupOptionsCt extends HTMLElement {\n  children: HTMLCollectionOf<UxOptionElement>;\n}\n\n@inject(DOM.Element, BindingEngine)\n@processContent(extractUxOptions)\n@customElement('ux-optgroup')\n@inlineView(UX_OPTGROUP_VIEW)\nexport class UxOptGroup {\n\n  private subscriptions: Disposable[];\n  private parentDisabled: boolean;\n\n  @bindable()\n  public label: string;\n\n  public disabled: boolean;\n  public isDisabled: boolean;\n  public readonly optionsCt: OptGroupOptionsCt;\n\n  constructor(\n    public readonly element: UxOptGroupElement,\n    private bindingEngine: BindingEngine\n  ) {\n    Object.setPrototypeOf(element, UxOptGroupElementProto);\n  }\n\n  public created() {\n    const element = this.element;\n    this.setDisabled(element.hasAttribute('disabled'));\n    element.removeAttribute('disabled');\n  }\n\n  public bind() {\n    const uxSelect = this.uxSelect = this.getUxSelect();\n    this.setParentDisabled(uxSelect.isDisabled);\n  }\n\n  public attached() {\n    const be = this.bindingEngine;\n    const uxSelect = this.uxSelect;\n    this.subscriptions = [\n      be.propertyObserver(uxSelect, 'isDisabled').subscribe(this.setParentDisabled.bind(this))\n    ];\n  }\n\n  public detached() {\n    for (const s of this.subscriptions) {\n      s.dispose();\n    }\n    this.subscriptions.length = 0;\n  }\n\n  private getUxSelect() {\n    let el: HTMLElement | null = this.element;\n    while (el) {\n      if (el.tagName === 'UX-SELECT') {\n        return getAuViewModel<UxOptGroup['uxSelect']>(el);\n      }\n      el = el.parentElement;\n    }\n    throw new Error('Ux option group has no \"ux-select\" parent');\n  }\n\n  private setParentDisabled(disabled: boolean) {\n    this.parentDisabled = !!disabled;\n    this.isDisabled = this.disabled || this.parentDisabled;\n  }\n\n  public getOptions(): UxOptionElement[] {\n    if (!this.optionsCt) {\n      return [];\n    }\n    return Array.from(this.optionsCt.children);\n  }\n\n  public getDisabled() {\n    return this.disabled;\n  }\n\n  public setDisabled(disabled: boolean) {\n    this.disabled = disabled;\n    this.isDisabled = disabled || this.parentDisabled;\n  }\n}\n\nfunction extractUxOptions(\n  _: ViewCompiler,\n  __: ViewResources,\n  node: Element\n) {\n  let currentChild: any = node.firstChild;\n  while (currentChild) {\n    const nextSibling = currentChild.nextSibling;\n    if (currentChild.nodeName !== 'UX-OPTION') {\n      node.removeChild(currentChild);\n    }\n    currentChild = nextSibling;\n  }\n  return true;\n}\n\nconst UxOptGroupElementProto = Object.create(HTMLElement.prototype, {\n  options: {\n    get() {\n      return getAuViewModel<UxOptGroup>(this).getOptions();\n    }\n  },\n  disabled: {\n    get() {\n      return getAuViewModel<UxOptGroup>(this).getDisabled();\n    },\n    set(disabled: boolean) {\n      return getAuViewModel<UxOptGroup>(this).setDisabled(disabled);\n    }\n  }\n});\n","import {\n  inject,\n  bindable,\n  DOM,\n  ElementEvents,\n  PLATFORM,\n  ViewCompiler,\n  ViewResources,\n  customElement,\n  Disposable,\n  BindingEngine,\n  inlineView,\n  processAttributes,\n} from 'aurelia-framework';\n\nimport {\n  PaperRipple\n} from '@aurelia-ux/core';\n\nimport { getAuViewModel } from './util';\nimport * as UX_OPTION_VIEW from './ux-option.html';\n\nexport interface UxOptionElement extends HTMLElement {\n  disabled: boolean;\n  focused: boolean;\n  nodeName: 'UX-OPTION';\n  selected: boolean;\n  ripple: PaperRipple;\n  value: any;\n  wave(): void;\n}\n\nexport interface UxOptionSelectEvent extends Event {\n  target: UxOptionElement;\n}\n\n@inject(DOM.Element, BindingEngine)\n@customElement('ux-option')\n@processAttributes(convertTextToAttr)\n@inlineView(UX_OPTION_VIEW)\nexport class UxOption {\n\n  private selected: boolean = false;\n\n  private subscriptions: Disposable[];\n\n  public disabled: boolean;\n  public parentDisabled: boolean;\n  public isDisabled: boolean;\n  public focused: boolean = false;\n\n  public isMultiple: boolean;\n\n  // populated by aurelia\n  public readonly textEl: HTMLElement;\n\n  @bindable()\n  public text: string;\n\n  @bindable()\n  public value: any;\n\n  constructor(\n    public readonly element: UxOptionElement,\n    private bindingEngine: BindingEngine\n  ) {\n    Object.setPrototypeOf(element, UxOptionElementProto);\n  }\n\n  public created() {\n    const element = this.element;\n\n    if (element.hasAttribute('value')) {\n      this.value = element.getAttribute('value');\n    }\n\n    this.setDisabled(element.hasAttribute('disabled'));\n    element.removeAttribute('disabled');\n    element.removeAttribute('text');\n  }\n\n  public bind() {\n    if (this.value === undefined) {\n      this.value = this.text;\n    }\n  }\n\n  public attached() {\n    const optGroup = this.optGroup = this.getOptGroup();\n    const uxSelect = this.uxSelect = this.getUxSelect();\n    const bindingEngine = this.bindingEngine;\n    this.setParentDisabled(optGroup ? optGroup.isDisabled : uxSelect.isDisabled);\n    this.isMultiple = uxSelect.isMultiple;\n    this.subscriptions = [\n      bindingEngine.propertyObserver(uxSelect, 'isMultiple').subscribe(this.uxMultipleChanged.bind(this)),\n      optGroup\n        // ux-opt group will also subscribe to ux-select to know if it's disabled\n        ? bindingEngine.propertyObserver(optGroup, 'isDisabled').subscribe(this.setParentDisabled.bind(this))\n        // If ux-option is not a member of a group, then subscribe to disabled state of ux-select\n        : bindingEngine.propertyObserver(uxSelect, 'isDisabled').subscribe(this.setParentDisabled.bind(this))\n    ];\n  }\n\n  public detached() {\n    for (const s of this.subscriptions) {\n      s.dispose();\n    }\n    this.subscriptions.length = 0;\n  }\n\n  private getOptGroup() {\n    let el: HTMLElement | null = this.element;\n    while (el) {\n      if (el.tagName === 'UX-OPTGROUP') {\n        return getAuViewModel<UxOption['optGroup']>(el);\n      }\n      el = el.parentElement;\n    }\n    return null;\n  }\n\n  private getUxSelect() {\n    let el: HTMLElement | null = this.element;\n    while (el) {\n      if (el.tagName === 'UX-SELECT') {\n        return getAuViewModel<UxOption['uxSelect']>(el);\n      }\n      el = el.parentElement;\n    }\n    throw new Error('Ux option has no \"ux-select\" parent');\n  }\n\n  private uxMultipleChanged(useSelect: boolean) {\n    this.isMultiple = useSelect;\n  }\n\n  private setParentDisabled(disabled: boolean) {\n    this.parentDisabled = !!disabled;\n    this.isDisabled = this.disabled || this.parentDisabled;\n  }\n\n  private notify() {\n    this.element.dispatchEvent(DOM.createCustomEvent('select', { bubbles: true, detail: this.element }));\n  }\n\n  public getFocused() {\n    return this.focused;\n  }\n\n  public setFocused(focused: boolean) {\n    this.focused = !!focused;\n  }\n\n  public getSelected() {\n    return this.selected;\n  }\n\n  public setSelected(selected: boolean) {\n    const oldValue = this.selected;\n    const newValue = !!selected;\n    if (newValue !== oldValue) {\n      this.selected = newValue;\n      this.notify();\n    }\n  }\n\n  public getDisabled() {\n    return this.disabled || this.parentDisabled;\n  }\n\n  public setDisabled(disabled: boolean) {\n    this.disabled = !!disabled;\n    this.isDisabled = this.disabled || this.parentDisabled;\n  }\n\n  public onClick() {\n    if (!this.disabled) {\n      if (this.isMultiple) {\n        this.setSelected(!this.selected);\n      } else {\n        this.selected = true;\n        this.notify();\n      }\n    }\n  }\n\n  public onMouseDown(e: MouseEvent) {\n    this.addWave(e);\n    return true;\n  }\n\n  /**\n   * @param autoEnd Internal flag to distinguish between keyboard navigation and mouse\n   */\n  public addWave(e?: MouseEvent | null, autoEnd?: boolean) {\n    const target = this.element;\n\n    if (target.classList.contains('ripple')) {\n      if (target.ripple === null || target.ripple === undefined) {\n        target.ripple = new PaperRipple();\n        target.appendChild(target.ripple.$);\n      }\n\n      target.ripple.downAction(e!);\n      if (autoEnd) {\n        setTimeout(removeWave, 125, target);\n      } else {\n        new ElementEvents(PLATFORM.global).subscribeOnce('mouseup', () => {\n          target.ripple.upAction();\n        }, true);\n      }\n    }\n  }\n}\n\nfunction removeWave(el: UxOptionElement) {\n  el.ripple.upAction();\n}\n\nfunction convertTextToAttr(_: ViewCompiler, __: ViewResources, node: UxOptionElement, attributes: NamedNodeMap) {\n  const ii = attributes.length;\n  for (let i = 0; ii > i; ++i) {\n    const attr = attributes[i];\n    if (attr.nodeName === 'text') {\n      return;\n    }\n    const parts = attr.nodeName.split('.');\n    if (parts[0] === 'text') {\n      return;\n    }\n  }\n  node.setAttribute('text', node.textContent || '');\n  node.textContent = '';\n}\n\nconst UxOptionElementProto = Object.create(HTMLElement.prototype, {\n  disabled: {\n    get() {\n      return getAuViewModel<UxOption>(this).getDisabled();\n    },\n    set(disabled: boolean) {\n      getAuViewModel<UxOption>(this).setDisabled(disabled);\n    }\n  },\n  focused: {\n    get() {\n      return getAuViewModel<UxOption>(this).getFocused();\n    },\n    set(focused: boolean) {\n      getAuViewModel<UxOption>(this).setFocused(focused);\n    }\n  },\n  selected: {\n    get() {\n      return getAuViewModel<UxOption>(this).getSelected();\n    },\n    set(selected: boolean) {\n      getAuViewModel<UxOption>(this).setSelected(selected);\n    }\n  },\n  value: {\n    get() {\n      return getAuViewModel<UxOption>(this).value;\n    },\n    set(value: any) {\n      getAuViewModel<UxOption>(this).value = value;\n    }\n  },\n  wave: {\n    value(): void {\n      getAuViewModel<UxOption>(this).addWave(null, true);\n    }\n  }\n});\n","import { UxTheme } from '@aurelia-ux/core';\n\nexport class UxSelectTheme implements UxTheme {\n  public themeKey = 'select';\n\n  public foreground: string;\n  public background: string;\n\n  public triggerBorder: string;\n  public triggerBorderDisabled: string;\n  public triggerBorderFocused: string;\n\n  public listMaxWidth: number;\n  public listMaxWidthPx: string;\n  public listMaxHeight: number;\n  public listMaxHeightPx: string;\n  public listBackground: string;\n  public listTransition: number;\n  public listTransitionS: string;\n\n  public optionHover: string;\n  public optionFocused: string;\n  public optionSelected: string;\n\n  public borderBottom: string;\n  public borderBottomHover: string;\n  public borderBottomSelected: string;\n\n  public listboxShadow: string;\n\n  public error: string;\n}\n","/// <reference path=\"html.d.ts\" />\nimport {\n  FrameworkConfiguration,\n  bindingMode,\n} from 'aurelia-framework';\n\nimport { ValueAttributeObserver, EventSubscriber } from 'aurelia-binding';\n\nimport { AureliaUX } from '@aurelia-ux/core';\nimport { UxSelect } from './ux-select';\nimport { UxOptGroup } from './ux-optgroup';\nimport { UxOption } from './ux-option';\n\nexport { UxOption, UxOptionElement } from './ux-option';\nexport { UxOptGroup, UxOptGroupElement } from './ux-optgroup';\nexport { UxSelect, UxSelectElement } from './ux-select';\nexport { UxSelectTheme } from './ux-select-theme';\n\nexport function configure(config: FrameworkConfiguration) {\n  config.container.get(AureliaUX).registerUxElementConfig(uxSelectConfig);\n  config.globalResources([\n    UxSelect,\n    UxOptGroup,\n    UxOption\n  ]);\n}\n\nconst uxSelectConfig = {\n  tagName: 'ux-select',\n  properties: {\n    value: {\n      defaultBindingMode: bindingMode.twoWay,\n      getObserver(element: Element, _: string) {\n        return new ValueAttributeObserver(element, 'value', new EventSubscriber(['change']));\n      }\n    }\n  }\n};\n"],"names":["getLogger","ElementEvents","PLATFORM","DOM","bindable","computedFrom","inject","StyleEngine","ObserverLocator","TaskQueue","processContent","customElement","inlineView","BindingEngine","PaperRipple","processAttributes","AureliaUX","bindingMode","ValueAttributeObserver","EventSubscriber"],"mappings":"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"}
{"version":3,"file":"index.js","sources":["../../src/ux-textarea.ts","../../src/ux-textarea-theme.ts","../../src/index.ts"],"sourcesContent":["import { customElement, bindable, inlineView } from 'aurelia-templating';\nimport { DOM } from 'aurelia-pal';\nimport { inject } from 'aurelia-dependency-injection';\nimport { StyleEngine, UxComponent } from '@aurelia-ux/core';\nimport { UxTextAreaTheme } from './ux-textarea-theme';\nimport { observable } from 'aurelia-framework';\nimport * as VIEW from './ux-textarea.html';\n\nexport interface UxTextAreaElement extends HTMLElement {\n  value: string;\n}\n\n@inject(Element, StyleEngine)\n@customElement('ux-textarea')\n@inlineView(VIEW)\nexport class UxTextArea implements UxComponent {\n  private ignoreRawChanges: boolean;\n  private isAttached: boolean;\n\n  @bindable public autocomplete: string;\n  @bindable public autofocus: boolean | string | null = null;\n  @bindable public autoResize: boolean | string = false;\n  @bindable public cols: number;\n  @bindable public disabled: boolean | string = false;\n  @bindable public focus: boolean | string = false;\n  @bindable public maxlength: number;\n  @bindable public minlength: number;\n  @bindable public readonly: boolean | string = false;\n  @bindable public rows: number;\n  @bindable public theme: UxTextAreaTheme;\n\n  @observable({ initializer: () => '' })\n  public rawValue: string;\n\n  public value: any = undefined;\n\n  public textbox: HTMLTextAreaElement;\n\n  constructor(private element: UxTextAreaElement, private styleEngine: StyleEngine) {\n    Object.setPrototypeOf(element, uxTextAreaElementProto);\n  }\n\n  public bind() {\n\n    const element = this.element;\n    const textbox = this.textbox;\n\n    if (this.autofocus || this.autofocus === '') {\n      this.focus = true;\n    }\n\n    if (element.hasAttribute('placeholder')) {\n      const attributeValue = element.getAttribute('placeholder');\n\n      if (attributeValue) {\n        textbox.setAttribute('placeholder', attributeValue);\n        element.removeAttribute('placeholder');\n      }\n    }\n\n    if (this.cols) {\n      textbox.setAttribute('cols', this.cols.toString());\n      element.removeAttribute('cols');\n    }\n\n    if (this.rows) {\n      textbox.setAttribute('rows', this.rows.toString());\n      element.removeAttribute('rows');\n    }\n\n    if (this.minlength) {\n      textbox.setAttribute('minlength', this.minlength.toString());\n    }\n\n    if (this.maxlength) {\n      textbox.setAttribute('maxlength', this.maxlength.toString());\n    }\n\n    this.autocompleteChanged(this.autocomplete);\n  }\n\n  public attached() {\n    const textbox = this.textbox;\n    this.isAttached = true;\n    this.textbox.addEventListener('change', stopEvent);\n    this.textbox.addEventListener('input', stopEvent);\n    this.fitTextContent();\n\n    textbox.addEventListener('change', stopEvent);\n    textbox.addEventListener('input', stopEvent);\n  }\n\n  public detached() {\n    const textbox = this.textbox;\n    this.isAttached = false;\n\n    textbox.removeEventListener('change', stopEvent);\n    textbox.removeEventListener('input', stopEvent);\n  }\n\n  public getValue() {\n    return this.value;\n  }\n\n  public setValue(value: any) {\n    const oldValue = this.value;\n    const newValue = value === null || value === undefined ? null : value.toString();\n\n    if (oldValue !== newValue) {\n      this.value = newValue;\n      this.ignoreRawChanges = true;\n      this.rawValue = newValue === null ? '' : newValue.toString();\n      this.fitTextContent();\n      this.ignoreRawChanges = false;\n      this.element.dispatchEvent(DOM.createCustomEvent('change', { bubbles: true }));\n    }\n  }\n\n  public autocompleteChanged(newValue: any) {\n    if (newValue != null) {\n      this.textbox.setAttribute('autocomplete', newValue);\n    } else {\n      this.textbox.removeAttribute('autocomplete');\n    }\n  }\n\n  public rawValueChanged(rawValue: string) {\n    if (this.ignoreRawChanges) {\n      return;\n    }\n    this.setValue(rawValue);\n  }\n\n  public themeChanged(newValue: any) {\n    if (newValue != null && newValue.themeKey == null) {\n      newValue.themeKey = 'textarea';\n    }\n\n    this.styleEngine.applyTheme(newValue, this.element);\n  }\n\n  public fitTextContent() {\n    if (this.isAttached && (this.autoResize || this.autoResize === '')) {\n      this.textbox.style.height = 'auto';\n      this.textbox.style.height = `${this.textbox.scrollHeight + 2}px`;\n    }\n  }\n\n  public focusChanged(focus: boolean | string) {\n    focus = focus || focus === '' ? true : false;\n    this.element.dispatchEvent(DOM.createCustomEvent(focus ? 'focus' : 'blur', { bubbles: true }));\n  }\n}\n\nfunction stopEvent(e: Event) {\n  e.stopPropagation();\n}\n\nconst getVm = <T>(_: any) => _.au.controller.viewModel as T;\nconst uxTextAreaElementProto = Object.create(HTMLElement.prototype, {\n  value: {\n    get() {\n      return getVm<UxTextArea>(this).getValue();\n    },\n    set(value: any) {\n      getVm<UxTextArea>(this).setValue(value);\n    }\n  }\n});\n","import { UxTheme } from '@aurelia-ux/core';\n\nexport class UxTextAreaTheme implements UxTheme {\n  public themeKey = 'textarea';\n\n  public foreground: string;\n  public background: string;\n\n  public borderBottom: string;\n  public borderBottomHover: string;\n  public borderBottomSelected: string;\n\n  public diabledForeground: string;\n  public disabledBorderBottom: string;\n\n  public fullWidthBorder: string;\n  public fullWidthForeground: string;\n  public fullWidthBackground: string;\n  public fullWidthBackgroundDisabled: string;\n\n  public error: string;\n}\n","/// <reference path=\"html.d.ts\" />\nimport { FrameworkConfiguration, bindingMode } from 'aurelia-framework';\nimport { ValueAttributeObserver, EventSubscriber } from 'aurelia-binding';\nimport { AureliaUX } from '@aurelia-ux/core';\nimport { UxTextArea } from './ux-textarea';\n\nexport { UxTextAreaTheme } from './ux-textarea-theme';\nexport { UxTextArea, UxTextAreaElement } from './ux-textarea';\n\nexport function configure(config: FrameworkConfiguration) {\n  config.container.get(AureliaUX).registerUxElementConfig(uxTextAreaConfig);\n  config.globalResources(UxTextArea);\n}\n\nconst uxTextAreaConfig = {\n  tagName: 'ux-textarea',\n  properties: {\n    value: {\n      defaultBindingMode: bindingMode.twoWay,\n      getObserver(element: Element) {\n        return new ValueAttributeObserver(element, 'value', new EventSubscriber(['change']));\n      }\n    }\n  }\n};\n"],"names":["DOM","bindable","observable","inject","StyleEngine","customElement","inlineView","AureliaUX","bindingMode","ValueAttributeObserver","EventSubscriber"],"mappings":"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"}
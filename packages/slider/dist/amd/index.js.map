{"version":3,"file":"index.js","sources":["../../src/ux-slider.ts","../../src/ux-slider-theme.ts","../../src/index.ts"],"sourcesContent":["import { customElement, bindable, ElementEvents, inlineView } from 'aurelia-templating';\nimport { inject } from 'aurelia-dependency-injection';\nimport { StyleEngine, UxComponent } from '@aurelia-ux/core';\nimport { UxSliderTheme } from './ux-slider-theme';\nimport { computedFrom, bindingMode } from 'aurelia-binding';\nimport * as VIEW from './ux-slider.html';\n\nexport interface UxSliderElement extends HTMLElement {\n  value: number;\n}\n\n@inject(Element, StyleEngine)\n@customElement('ux-slider')\n@inlineView(VIEW)\nexport class UxSlider implements UxComponent {\n  private isActive: boolean;\n  private percentValue: number;\n\n  @bindable public theme: UxSliderTheme;\n  @bindable({ defaultBindingMode: bindingMode.twoWay }) public value: number;\n  @bindable public min: number;\n  @bindable public max: number;\n  @bindable public disabled: boolean;\n  @bindable public step: number;\n\n  constructor(\n    public element: UxSliderElement,\n    private styleEngine: StyleEngine) {\n      Object.setPrototypeOf(element, uxSliderElementProto);\n    }\n\n  @computedFrom('percentValue')\n  get sliderBeforeWidth(): number {\n    return this.percentValue * 100;\n  }\n\n  @computedFrom('percentValue')\n  get sliderAfterWidth(): number {\n    return (1 - this.percentValue) * 100;\n  }\n\n  public bind() {\n    this.themeChanged(this.theme);\n\n    this.minChanged();\n    this.maxChanged();\n    this.valueChanged();\n    this.stepChanged();\n  }\n\n  public stepChanged() {\n    if (this.step === undefined || this.step === null) {\n      this.step = 1;\n      return;\n    }\n\n    this.step = Number(this.step);\n  }\n\n  public themeChanged(newValue: any) {\n    if (newValue != null && newValue.themeKey == null) {\n      newValue.themeKey = 'slider';\n    }\n\n    this.styleEngine.applyTheme(newValue, this.element);\n  }\n\n  public minChanged() {\n    if (this.min === undefined || this.min === null) {\n      this.min = 0;\n      return;\n    }\n\n    this.min = Number(this.min);\n  }\n\n  public maxChanged() {\n    if (this.max === undefined || this.max === null) {\n      this.max = 100;\n      return;\n    }\n\n    this.max = Number(this.max);\n  }\n\n  public valueChanged() {\n    if (this.value === undefined || this.value === null) {\n      this.value = this.min;\n      this.percentValue = 0;\n      return;\n    }\n\n    const percentValue = (this.value - this.min) / (this.max - this.min);\n\n    this.percentValue = percentValue > 1\n      ? 1\n      : percentValue < 0\n        ? 0\n        : percentValue;\n  }\n\n  public updateValue(currentMouseX: number) {\n    const normalizedMouseX = currentMouseX - this.element.offsetLeft;\n    const percentValue = normalizedMouseX / this.element.clientWidth;\n    const rawValue = ((this.max - this.min) * percentValue) + this.min;\n    const numSteps = Math.round((rawValue - this.min) / this.step);\n    const steppedValue = this.min + (this.step * numSteps);\n\n    this.value = this.boundValue(steppedValue);\n  }\n\n  public onTrackMouseDown() {\n    if (this.disabled) {\n      return;\n    }\n\n    this.isActive = true;\n\n    const winEvents = new ElementEvents(window as any);\n    const upAction = (e: MouseEvent) => {\n      if (!this.isActive) {\n        return;\n      }\n\n      this.updateValue(e.clientX);\n      this.isActive = false;\n\n      winEvents.disposeAll();\n    };\n    winEvents.subscribe('blur', upAction, true);\n    winEvents.subscribe('mouseup', upAction, true);\n    winEvents.subscribe('mousemove', this.onMouseMove.bind(this), true);\n  }\n\n  public onKeyDown(e: KeyboardEvent) {\n    const steppedValue = e.keyCode === 37 || e.keyCode === 40\n      ? this.value - this.step\n      : e.keyCode === 38 || e.keyCode === 39\n        ? this.value + this.step\n        : this.value;\n\n    this.value = this.boundValue(steppedValue);\n\n    return true;\n  }\n\n  public getValue() {\n    return this.value;\n  }\n\n  public setValue(value: number) {\n    this.value = value;\n  }\n\n  private onMouseMove(e: MouseEvent) {\n    this.updateValue(e.clientX);\n  }\n\n  private boundValue(potentialValue: number) {\n    return potentialValue > this.max\n      ? this.max\n      : potentialValue < this.min\n        ? this.min\n        : potentialValue;\n  }\n}\n\nconst getVm = <T>(_: any) => _.au.controller.viewModel as T;\nconst uxSliderElementProto = Object.create(HTMLElement.prototype, {\n  value: {\n    get() {\n      return getVm<UxSlider>(this).getValue();\n    },\n    set(value: number) {\n      getVm<UxSlider>(this).setValue(value);\n    }\n  }\n});","import { UxTheme } from '@aurelia-ux/core';\n\nexport class UxSliderTheme implements UxTheme {\n  public themeKey = 'slider';\n\n  public background: string;\n  public disabledBackground: string;\n  public thumbDiameter: string;\n}","/// <reference path=\"html.d.ts\" />\nimport { FrameworkConfiguration } from 'aurelia-framework';\nimport { UxSlider } from './ux-slider';\n\nexport { UxSliderTheme } from './ux-slider-theme';\nexport { UxSlider, UxSliderElement } from './ux-slider';\n\nexport function configure(config: FrameworkConfiguration) {\n  config.globalResources(UxSlider);\n}\n"],"names":["ElementEvents","bindable","bindingMode","computedFrom","inject","StyleEngine","customElement","inlineView"],"mappings":"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"}
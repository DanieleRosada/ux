{"version":3,"file":"index.js","sources":["../../src/ux-slider.ts","../../src/ux-slider-theme.ts","../../src/index.ts"],"sourcesContent":["import { customElement, bindable, ElementEvents, inlineView } from 'aurelia-templating';\nimport { inject } from 'aurelia-dependency-injection';\nimport { StyleEngine, UxComponent } from '@aurelia-ux/core';\nimport { UxSliderTheme } from './ux-slider-theme';\nimport { computedFrom, bindingMode } from 'aurelia-binding';\nimport * as VIEW from './ux-slider.html';\n\nexport interface UxSliderElement extends HTMLElement {\n  value: number;\n}\n\n@inject(Element, StyleEngine)\n@customElement('ux-slider')\n@inlineView(VIEW)\nexport class UxSlider implements UxComponent {\n  private isActive: boolean;\n  private percentValue: number;\n\n  @bindable public theme: UxSliderTheme;\n  @bindable({ defaultBindingMode: bindingMode.twoWay }) public value: number;\n  @bindable public min: number;\n  @bindable public max: number;\n  @bindable public disabled: boolean;\n  @bindable public step: number;\n\n  constructor(\n    public element: UxSliderElement,\n    private styleEngine: StyleEngine) {\n      Object.setPrototypeOf(element, uxSliderElementProto);\n    }\n\n  @computedFrom('percentValue')\n  get sliderBeforeWidth(): number {\n    return this.percentValue * 100;\n  }\n\n  @computedFrom('percentValue')\n  get sliderAfterWidth(): number {\n    return (1 - this.percentValue) * 100;\n  }\n\n  public bind() {\n    this.themeChanged(this.theme);\n\n    this.minChanged();\n    this.maxChanged();\n    this.valueChanged();\n    this.stepChanged();\n  }\n\n  public stepChanged() {\n    if (this.step === undefined || this.step === null) {\n      this.step = 1;\n      return;\n    }\n\n    this.step = Number(this.step);\n  }\n\n  public themeChanged(newValue: any) {\n    if (newValue != null && newValue.themeKey == null) {\n      newValue.themeKey = 'slider';\n    }\n\n    this.styleEngine.applyTheme(newValue, this.element);\n  }\n\n  public minChanged() {\n    if (this.min === undefined || this.min === null) {\n      this.min = 0;\n      return;\n    }\n\n    this.min = Number(this.min);\n  }\n\n  public maxChanged() {\n    if (this.max === undefined || this.max === null) {\n      this.max = 100;\n      return;\n    }\n\n    this.max = Number(this.max);\n  }\n\n  public valueChanged() {\n    if (this.value === undefined || this.value === null) {\n      this.value = this.min;\n      this.percentValue = 0;\n      return;\n    }\n\n    const percentValue = (this.value - this.min) / (this.max - this.min);\n\n    this.percentValue = percentValue > 1\n      ? 1\n      : percentValue < 0\n        ? 0\n        : percentValue;\n  }\n\n  public updateValue(currentMouseX: number) {\n    const normalizedMouseX = currentMouseX - this.element.offsetLeft;\n    const percentValue = normalizedMouseX / this.element.clientWidth;\n    const rawValue = ((this.max - this.min) * percentValue) + this.min;\n    const numSteps = Math.round((rawValue - this.min) / this.step);\n    const steppedValue = this.min + (this.step * numSteps);\n\n    this.value = this.boundValue(steppedValue);\n  }\n\n  public onTrackMouseDown() {\n    if (this.disabled) {\n      return;\n    }\n\n    this.isActive = true;\n\n    const winEvents = new ElementEvents(window as any);\n    const upAction = (e: MouseEvent) => {\n      if (!this.isActive) {\n        return;\n      }\n\n      this.updateValue(e.clientX);\n      this.isActive = false;\n\n      winEvents.disposeAll();\n    };\n    winEvents.subscribe('blur', upAction, true);\n    winEvents.subscribe('mouseup', upAction, true);\n    winEvents.subscribe('mousemove', this.onMouseMove.bind(this), true);\n  }\n\n  public onKeyDown(e: KeyboardEvent) {\n    const steppedValue = e.keyCode === 37 || e.keyCode === 40\n      ? this.value - this.step\n      : e.keyCode === 38 || e.keyCode === 39\n        ? this.value + this.step\n        : this.value;\n\n    this.value = this.boundValue(steppedValue);\n\n    return true;\n  }\n\n  public getValue() {\n    return this.value;\n  }\n\n  public setValue(value: number) {\n    this.value = value;\n  }\n\n  private onMouseMove(e: MouseEvent) {\n    this.updateValue(e.clientX);\n  }\n\n  private boundValue(potentialValue: number) {\n    return potentialValue > this.max\n      ? this.max\n      : potentialValue < this.min\n        ? this.min\n        : potentialValue;\n  }\n}\n\nconst getVm = <T>(_: any) => _.au.controller.viewModel as T;\nconst uxSliderElementProto = Object.create(HTMLElement.prototype, {\n  value: {\n    get() {\n      return getVm<UxSlider>(this).getValue();\n    },\n    set(value: number) {\n      getVm<UxSlider>(this).setValue(value);\n    }\n  }\n});","import { UxTheme } from '@aurelia-ux/core';\n\nexport class UxSliderTheme implements UxTheme {\n  public themeKey = 'slider';\n\n  public background: string;\n  public disabledBackground: string;\n  public thumbDiameter: string;\n}","/// <reference path=\"html.d.ts\" />\nimport { FrameworkConfiguration } from 'aurelia-framework';\nimport { UxSlider } from './ux-slider';\n\nexport { UxSliderTheme } from './ux-slider-theme';\nexport { UxSlider, UxSliderElement } from './ux-slider';\n\nexport function configure(config: FrameworkConfiguration) {\n  config.globalResources(UxSlider);\n}\n"],"names":["ElementEvents","bindable","bindingMode","computedFrom","inject","StyleEngine","customElement","inlineView"],"mappings":"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"}